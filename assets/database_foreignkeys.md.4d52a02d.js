import{_ as s,c as n,o as a,a as e}from"./app.5353d95f.js";const g=JSON.parse('{"title":"Foreign Keys in Laravel","description":"","frontmatter":{},"headers":[{"level":2,"title":"Modern Syntax","slug":"modern-syntax","link":"#modern-syntax","children":[]},{"level":2,"title":"Legacy Setup (for integer IDs)","slug":"legacy-setup-for-integer-ids","link":"#legacy-setup-for-integer-ids","children":[]},{"level":2,"title":"foreignId() vs foreign()","slug":"foreignid-vs-foreign","link":"#foreignid-vs-foreign","children":[]}],"relativePath":"database/foreignkeys.md"}'),o={name:"database/foreignkeys.md"},l=e(`<h1 id="foreign-keys-in-laravel" tabindex="-1">Foreign Keys in Laravel <a class="header-anchor" href="#foreign-keys-in-laravel" aria-hidden="true">#</a></h1><h2 id="modern-syntax" tabindex="-1">Modern Syntax <a class="header-anchor" href="#modern-syntax" aria-hidden="true">#</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">foreignId</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">constrained</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span></code></pre></div><ul><li>Creates <code>unsignedBigInteger(&#39;user_id&#39;)</code></li><li>Adds foreign key to table <code>users</code> on column <code>id</code> (name conventions).</li></ul><p>With cascade:</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">foreignId</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">constrained</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">onUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cascade</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">cascadeOnUpdate</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// or $table-&gt;restrictOnUpdate();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">cascadeOnDelete</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// or -&gt;nullOnDelete() / -&gt;restrictOnDelete()</span></span>
<span class="line"></span></code></pre></div><p>Custom table/index:</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">foreignId</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">constrained</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">posts_user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">users</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="legacy-setup-for-integer-ids" tabindex="-1">Legacy Setup (for <code>integer</code> IDs) <a class="header-anchor" href="#legacy-setup-for-integer-ids" aria-hidden="true">#</a></h2><p>In older Laravel apps, <code>$table-&gt;id()</code> created an unsigned <code>integer</code> instead of <code>bigInteger</code>.<br> Because <code>foreignId()</code> always creates an <code>unsignedBigInteger</code>, it will <strong>not match</strong> and cause foreign key errors.</p><p>You must either:</p><ol><li>Update the referenced column to <code>bigIncrements</code>, or</li><li>Define the key manually:</li></ol><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">integer</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">unsigned</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">foreign</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">references</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// constrained() does not work for foreign()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">on</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">users</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">cascadeOnUpdate</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// or $table-&gt;restrictOnUpdate();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">cascadeOnDelete</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// or -&gt;nullOnDelete() / -&gt;restrictOnDelete()</span></span>
<span class="line"></span></code></pre></div><h2 id="foreignid-vs-foreign" tabindex="-1"><code>foreignId()</code> vs <code>foreign()</code> <a class="header-anchor" href="#foreignid-vs-foreign" aria-hidden="true">#</a></h2><table><thead><tr><th>Feature</th><th><code>foreignId()</code></th><th><code>foreign()</code></th></tr></thead><tbody><tr><td>Return type</td><td><code>Illuminate\\Support\\Fluent</code></td><td><code>Illuminate\\Database\\Schema\\ForeignKeyDefinition</code></td></tr><tr><td>Supports <code>-&gt;constrained()</code></td><td>\u2705 Yes</td><td>\u274C No</td></tr><tr><td>Supports <code>-&gt;references()</code></td><td>\u2705 Yes</td><td>\u2705 Yes</td></tr><tr><td>Column + FK shortcut</td><td>\u2705 Creates column and FK in one step</td><td>\u274C Only FK \u2013 column must exist beforehand</td></tr></tbody></table><blockquote><p>\u{1F4A1} Use <code>foreignId()</code> when your related table uses <code>bigIncrements</code>.<br> For legacy tables with <code>int</code> primary keys, use <code>foreign()</code> instead.</p></blockquote><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u2705 Modern approach</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">foreignId</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">constrained</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u2705 Legacy or full control</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">integer</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">unsigned</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">table</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">foreign</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">references</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">on</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">users</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">onDelete</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cascade</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><p>\u{1F449} <a href="https://laravel.com/docs/12.x/migrations#foreign-key-constraints" target="_blank" rel="noreferrer">Laravel Docs</a></p>`,18),p=[l];function t(r,c,D,F,y,d){return a(),n("div",null,p)}const A=s(o,[["render",t]]);export{g as __pageData,A as default};
